### 什么是索引？

索引是一种能帮助 MySQL 提高查询效率的数据结构

### 索引分别有哪些优点和缺点？

索引的优点如下：

```
- 快速访问数据表中的特定信息，提高检索速度。
- 创建唯一性索引，保证数据表中每一行数据的唯一性。
- 加速表与表之间的连接。
- 使用分组和排序进行数据检索时，可以显著减少查询中分组和排序的时间。


```

索引的缺点：

```
- 虽然提高了的查询速度，但却降低了更新表的速度，比如 update、insert，因为更新数据时，MySQL 不仅要更新数据，还要更新索引文件；
- 建立索引会占用磁盘文件的索引文件。
```

使用索引注意事项：

```
- 使用短索引，短索引不仅可以提高查询速度，更能节省磁盘空间和 I/O 操作；

- 索引列排序，MySQL 查询只使用一个索引，因此如果 where 子句中已经使用了索引的话，那么 order by 中的列是不会使用索引的，因此数据库默认排序可以符合要求的情况下，不要进行排序操作；尽量不要包含多个列的排序，如果需要最好给这些列创建复合索引；

- like 语句操作，一般情况下不鼓励使用 like 操作，如果非使用不可， 注意 like "%aaa%" 不会使用索引，而like "aaa%"可以使用索引；

- 查询的字段或者条件字段可以不与索引字段全部一致，但开头必须一致，且中间不能隔断。例如：abc->abc/ab/a

- 在索引列上做任何操作(计算、 函数、(自动or手动)类型转换)，会导致索引失效而转向全表扫描

  - 	错误的例子：select * from test where id-1=9;

    	 正确的例子：select * from test where id=10;

- 尽量使用覆盖索引（只访问索引的查询（查询列和索引列保持一致）），减少select*

- 当索引出现范围条件后，其后边的索引列将不能被使用

- MySQL在使用不等于(<>或!=)时无法使用索引，会导致全表扫描

- is null和is not null也无法使用索引

- or 也会引起索引失效

- 数据类型错误也会导致索引失效。例如表的字段tu_mdn定义为varchar2(20),但在查询时把该字段作为number类型以where条件传给mysql,这样会导致索引失效.

#### 两表

当使用left join时，左表是驱动表，右表是被驱动表，  右表建索引更好-》因为左连接左表一定会全表扫描的，右表部分扫描

当使用right join时，右表时驱动表，左表是被驱动表，  左表建索引更好-》因为右连接右表一定会全表扫描，左表部分扫描

当使用join时，mysql会选择数据量比较小的表作为驱动表，大表作为被驱动表。  大表使用索引

总结：多表连接时永远是被驱动表的索引起作用

#### 三表

- 小表驱动大表结果集
- 优先优化内存循环
- 保证join语句中被驱动表上join条件字段已经被索引
- 当无法保证被驱动表的join条件字段被索引内存资源充足的前提下，不要太吝啬JoinBuffer的设置


以下 SQL 有什么问题？该如何优化？

select * from t where f/2=100;
该 SQL 会导致引擎放弃索引而全表扫描，尽量避免在索引列上计算。可改为：

select * from t where f=100*2;
```



### 为什么 MySQL 官方建议使用自增主键作为表的主键？

```
索引的物理存储结构：https://blog.csdn.net/qq_37286668/article/details/112176944


mysql (注意本文讲的 mysql 默认为InnoDB 引擎)底层数据结构是 B+ 树，所谓的索引其实就是一颗 B+ 树，一个表有多少个索引就会有多少颗 B+ 树，mysql 中的数据都是按顺序保存在 B+ 树上的(所以说索引本身是有序的)。

然后 mysql 在底层又是以数据页为单位来存储数据的，一个数据页大小默认为 16k，当然你也可以自定义大小，也就是说如果一个数据页存满了，mysql 就会去申请一个新的数据页来存储数据。

如果主键为自增 id 的话，mysql 在写满一个数据页的时候，直接申请另一个新数据页接着写就可以了。

如果主键是非自增 id，为了确保索引有序，mysql 就需要将每次插入的数据都放到合适的位置上。

当往一个快满或已满的数据页中插入数据时，新插入的数据会将数据页写满，mysql 就需要申请新的数据页，并且把上个数据页中的部分数据挪到新的数据页上。

这就造成了页分裂，这个大量移动数据的过程是会严重影响插入效率的。

其实对主键 id 还有一个小小的要求，在满足业务需求的情况下，尽量使用占空间更小的主键 id，因为普通索引的叶子节点上保存的是主键 id 的值，如果主键 id 占空间较大的话，那将会成倍增加 mysql 空间占用大小。
```

