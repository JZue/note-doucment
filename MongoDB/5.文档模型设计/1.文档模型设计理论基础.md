mongodb的文档模型设计：

多形性：同一个集合可以包含不同字段

动态性：线上修改数据模型，完全无需兼容或感知

数据治理：支持使用json schema来规范数据模式，在保证模式灵活动态的前提下，提供数据治理能力

有什么意义呢？



### 模型设计的内嵌和引用方式的取舍

1. mongodb是推荐用内嵌的方式解决1对多，多对多的关系的
2. 对于内嵌文档太大，数MB或者超过16MB的情况，选择新建一个collection，引用的方式更合适
3. 内嵌文档获数组元素会被频繁修改，进而导致大量数据修改的情况，更适合引用方式。例如一个person上会有多个标签，然后如果某个标签的描述，如果用引用方式，则只需要修改某一个标签对应的一条记录即可，而不是有这个标签的person都需要修改。
4. 内嵌数组元素会持续增长并且没有封顶的情况。



### MongoDB引用设计的限制

1. $lookup查询的时候，被关联的表是不能被分片的。最多只支持主表分片的查询
2. mongodb无外键检查
3. $lookup只支持left outer join