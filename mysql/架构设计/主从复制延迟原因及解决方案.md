# MySql 复制性能优化
 
主从复制是异步的，只有事务在主库上执行完毕，并且已经记录到二进制日志以后，从库才可以从主库中读取二进制事务；

### 主从同步延迟的原因

1. 主库的写入二进制的日志的时间，即执行时间；因为，一般来说，主库要多少时间，从库就要多少时间，而且还要加网络传输的时间；

解决方案：主库大事务分割

2. 日志传输时间

使用mixed的日志格式；

3. 最大的因素：  默认情况下从库只有一个sql线程，主库并发的修改在从库变成了串行；

解决方案：使用多线程复制；

在mysql5.7及以后，可以使用逻辑时钟的方式来实现多线程复制；如何配置呢？
	
	stop slave
	set global slave_parallel_type='logical_clock'
	set global slave_parallel_worker=4
	start slave

我们知道， 一个服务器开放Ｎ个链接给客户端来连接的，　这样有会有大并发的更新操作, 但是从服务器的里面读取binlog 的线程仅有一个， 当某个SQL在从服务器上执行的时间稍长 或者由于某个SQL要进行锁表就会导致，主服务器的SQL大量积压，未被同步到从服务器里。这就导致了主从不一致， 也就是主从延迟。
