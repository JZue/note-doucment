cookie 的限制



## 什么是快照读和当前读

#### 快照读

读取的是记录的可见版本（但是不一定是最新版本），不加锁.select操作(不包括 select ... lock in share mode, select ... for update),我们平时用的就是快照读

#### 当前读

读取的是记录数据的最新版本，并且当前读返回的记录都会加上锁，保证其他事务不会再并发的修改这条记录。

select ... lock in share mode

select ... for update

insert

update

delete

## 乐观锁与悲观锁

#### 乐观锁

主观认为一般情况下数据不会造成冲突，所以在数据进行提交更新时才会对数据的冲突与否进行检测。如果没有冲突那就OK；如果出现冲突了，则返回错误信息并让用户决定如何去做。



















悲观锁的处理方式：

```
select * from user where uid=1 for update;
update user  set name='bac'  where uid=1;
```

乐观锁的处理方式：

一般就是加version字段