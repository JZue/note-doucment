MyISAM表级读写锁

​	读锁会阻塞写，但是不会阻塞读，写锁会阻塞读和写

 	show open tables 1-锁   0-无锁

InnoDB行锁  开销大，加锁慢，会出现死锁，粒度最小，并发度高

​	支持事务，支持行级锁

索引失效导致行锁变表锁





#### 什么是间隙锁

​	当我们用范围条件而不是相等条件检索数据，并请求共享或排他锁时，InnoDB会给符合条件的已有数据记录的索引项加锁；对于键值在条件范围内但不存在的记录，叫做“间隙(GAP)”，InnoDB也会对这个“间隙”加锁，这种锁机制就是所谓的间隙锁(NEXT-KEY)锁。

#### 危害

​	因为Query执行过程中通过范围查找的话，他会锁定整个范围内所有的索引键值，即使这个键值并不存在。
​	间隙锁有一个比较致命的弱点，就是当锁定一个范围键值之后，即使某些不存在的键值也会被无辜的锁定，而造成在锁定的时候无法插入锁定值范围内的任何数据，在某些场景下这可能会针对性造成很大的危害。